name: üì• GST PDF Automator

# This allows you to run the workflow manually and provide input
on:
  workflow_dispatch:
    inputs:
      pdf_url:
        description: 'The direct URL to the GST Notification PDF'
        required: true
        type: string
      commit_message:
        description: 'Optional: Custom commit message'
        required: false
        default: 'Auto-downloaded and renamed GST Notification'

jobs:
  download_and_commit:
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Checkout Repository
        uses: actions/checkout@v4
        # We need the token here to allow the commit/push step later
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          
      - name: üêç Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11' 
          
      - name: üì¶ Install dependencies
        run: pip install -r requirements.txt
        
      - name: ‚öôÔ∏è Run Python Script to Process PDF
        # Pass the user-provided URL as a command-line argument to the script
        run: python gst_processor.py ${{ github.event.inputs.pdf_url }}

      - name: üíæ Commit and Push Renamed File
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # Only commit if there are changes (i.e., a new file was saved)
          commit_message: ${{ github.event.inputs.commit_message }} - ${{ github.event.inputs.pdf_url }}
          # The files in the 'notifications' folder will be added
          file_pattern: notifications/*.pdf
          # Set the user for the commit
          commit_user_name: GST Bot
          commit_user_email: actions@github.com
          commit_author: GST Bot <actions@github.com>
